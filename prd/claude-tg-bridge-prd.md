# tgmux - PRD

## ä¸€å¥è¯æè¿°

é€šè¿‡ Telegram Bot + Topic è¿œç¨‹æ§åˆ¶æœ¬åœ° tmux ä¸­çš„å¤šç§ AI ç¼–ç¨‹åŠ©æ‰‹ä¼šè¯ï¼ˆClaude Code / Codex / Gemini / bashï¼‰ï¼ŒGo å®ç°ï¼Œå¯é€‰ Web UIã€‚

## æ ¸å¿ƒæ¶æ„

```
Telegram Message â”€â”€â”                    â”Œâ”€â”€ tmux window @0 â”€â”€ claude code (é¡¹ç›®A)
Telegram Topic A â”€â”€â”¤                    â”œâ”€â”€ tmux window @1 â”€â”€ codex (é¡¹ç›®B)
Telegram Topic B â”€â”€â”¼â”€â”€tgmux(Go,Polling) â”¼â”€â”€ tmux window @2 â”€â”€ gemini-cli (é¡¹ç›®C)
Telegram Topic C â”€â”€â”¤        â”‚           â”œâ”€â”€ tmux window @3 â”€â”€ bash (é¡¹ç›®A)
Telegram Topic D â”€â”€â”˜    Web UI (å¯é€‰)   â””â”€â”€ tmux window @4 â”€â”€ claude code (é¡¹ç›®D)
```

**æ˜ å°„å…³ç³»**: 1 Topicï¼ˆæˆ– 1 å¯¹ 1 ç§èŠï¼‰= 1 tmux window = 1 åç«¯ä¼šè¯ï¼ˆbackend + é¡¹ç›®ç›®å½•ï¼‰

## äº¤äº’æµç¨‹

### æ¶ˆæ¯å¤„ç†ï¼ˆç§èŠ / ç¾¤èŠ / Topic ç»Ÿä¸€ï¼‰

```
ç”¨æˆ·å‘é€æ¶ˆæ¯
  â†“
æŒ‰ chat_id æˆ– topic_id æŸ¥ç»‘å®š
  â†“
â”Œâ”€ å·²ç»‘å®š â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è½¬å‘åˆ°ç»‘å®šçš„ tmux çª—å£ï¼Œæ­£å¸¸äº¤äº’               â”‚
â”œâ”€ æœªç»‘å®š â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ£€æŸ¥ tmux ä¸­å·²æœ‰çª—å£                          â”‚
â”‚  â”Œâ”€ æœ‰å·²æœ‰ä¼šè¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  [claude @ my-project     (@0)]    â”‚      â”‚
â”‚  â”‚  [codex @ other-project   (@1)]    â”‚      â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚      â”‚
â”‚  â”‚  [â• æ–°å»ºä¼šè¯]                      â”‚      â”‚
â”‚  â”‚                                     â”‚      â”‚
â”‚  â”‚  é€‰å·²æœ‰ â†’ ç»‘å®šï¼Œè½¬å‘åŸå§‹æ¶ˆæ¯          â”‚      â”‚
â”‚  â”‚  é€‰æ–°å»º â†’ /new æµç¨‹                 â”‚      â”‚
â”‚  â”œâ”€ æ— å·²æœ‰ä¼šè¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚  ç›´æ¥è¿›å…¥ /new æµç¨‹                 â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### `/new` æ–°å»ºä¼šè¯

```
è§¦å‘ /new
  â†“
ä¸€æ¬¡æ€§å‘é€ä¸¤ç»„å†…è”é”®ç›˜ï¼š

â”Œâ”€ ğŸ“‚ é€‰æ‹©é¡¹ç›®ç›®å½• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [~/project-a]        (æœ€è¿‘ä½¿ç”¨)    â”‚
â”‚ [~/project-b]        (æ”¶è—)        â”‚
â”‚ [ğŸ“ è¾“å…¥è·¯å¾„...]                   â”‚
â”œâ”€ ğŸš€ å¯åŠ¨å‘½ä»¤ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [claude] [codex] [gemini] [bash]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â†“
ä¸¤é¡¹éƒ½é€‰å®Œåè§¦å‘åˆ›å»ºï¼ˆå·²é€‰é¡¹é«˜äº®ï¼‰
  â†“
åˆ›å»º tmux çª—å£ â†’ cd ç›®å½• â†’ å¯åŠ¨å‘½ä»¤ â†’ ç»‘å®š
  â†“
âœ… å·²åˆ›å»º claude ä¼šè¯ @ ~/project-a
```



## å¯åŠ¨å‘½ä»¤

| åç«¯ | tmux å†…å¯åŠ¨å‘½ä»¤ | æ—¥å¿—è·¯å¾„ | è¾“å‡ºç›‘æ§æ–¹å¼ |
|---|---|---|---|
| `claude` | `claude` æˆ– `claude --dangerously-skip-permissions` | `~/.claude/projects/<hash>/<session>.jsonl` | JSONL æ–‡ä»¶ç›‘æ§ |
| `codex` | `codex` | `~/.codex/sessions/YYYY/MM/DD/rollout-*.jsonl` | JSONL æ–‡ä»¶ç›‘æ§ |
| `gemini` | `gemini` | `~/.gemini/tmp/<hash>/chats/` | JSON æ–‡ä»¶ç›‘æ§ |
| `bash` | ç›´æ¥è¿›å…¥ shell | æ—  | tmux capture-pane è½®è¯¢ |

ä¸åŒåç«¯ç»Ÿä¸€é€šè¿‡ tmux send-keys å‘é€è¾“å…¥ã€‚AI å·¥å…·ä¼˜å…ˆä½¿ç”¨æ—¥å¿—æ–‡ä»¶ç›‘æ§ï¼ˆæ›´ç²¾å‡†ï¼‰ï¼Œbash ä½¿ç”¨ capture-pane è½®è¯¢å…œåº•ã€‚

## æŠ€æœ¯é€‰å‹

| ç»„ä»¶ | é€‰æ‹© | ç†ç”± |
|---|---|---|
| è¯­è¨€ | Go | å•äºŒè¿›åˆ¶éƒ¨ç½²ï¼Œå¹¶å‘åŸç”Ÿæ”¯æŒ |
| Telegram SDK | [go-telegram/bot](https://github.com/go-telegram/bot) | Telegram å®˜ç½‘æ¨èï¼Œé›¶ä¾èµ–ï¼Œæ”¯æŒ Bot API 9.4ï¼Œæ´»è·ƒç»´æŠ¤ |
| tmux äº¤äº’ | exec.Command è°ƒç”¨ tmux CLI | ç®€å•å¯é ï¼Œæ— éœ€ cgo |
| ä¼šè¯ç›‘æ§ | fsnotify + æ—¥å¿—æ–‡ä»¶ / capture-pane è½®è¯¢ | AI å·¥å…·ç”¨æ—¥å¿—æ–‡ä»¶ç›‘æ§ï¼Œbash ç”¨ capture-pane |
| Web UI | å†…åµŒ embed.FS + WebSocket | å•äºŒè¿›åˆ¶ï¼Œå¯é€šè¿‡é…ç½®å…³é—­ |
| é…ç½® | YAML å•æ–‡ä»¶ | ~/.tgmux/config.yaml |
| çŠ¶æ€æŒä¹…åŒ– | JSON æ–‡ä»¶ | ~/.tgmux/state.json |

## åŠŸèƒ½æ¸…å•

### P0 - æ ¸å¿ƒï¼ˆMVPï¼‰

**ä¼šè¯ç®¡ç†**
- `/new` - åœ¨åˆ›å»ºtopicçš„æ—¶å€™ï¼Œæˆ–è€…å‘é€æ¶ˆæ¯å‘ç°æ²¡æœ‰ç»‘å®šçš„æ—¶å€™ï¼ˆä¸ä¸»åŠ¨å‘ˆç°åœ¨é€‰é¡¹é‡Œå¤´ï¼‰
- `/sessionInfo` - æŸ¥çœ‹å½“å‰ç»‘å®šçš„ä¼šè¯è¯¦æƒ…ï¼ˆçª—å£IDã€é¡¹ç›®ç›®å½•ã€åç«¯ç±»å‹ã€å¯åŠ¨å‘½ä»¤ã€è¿è¡Œæ—¶é•¿ï¼‰
- `/sessionList` - åˆ—å‡ºæ‰€æœ‰ tmux ä¼šè¯çª—å£åŠç»‘å®šçŠ¶æ€ï¼Œæœªç»‘å®šçš„å¯ç›´æ¥ç‚¹å‡»ç»‘å®šåˆ°å½“å‰ Topic
 

**`/sessionInfo` è¾“å‡ºç¤ºä¾‹**
```
ğŸ“‹ å½“å‰ä¼šè¯ä¿¡æ¯
â”œâ”€ çª—å£:    @0
â”œâ”€ åç«¯:    claude
â”œâ”€ ç›®å½•:    ~/project/my-app
â”œâ”€ å‘½ä»¤:    claude --dangerously-skip-permissions
â”œâ”€ çŠ¶æ€:    è¿è¡Œä¸­
â””â”€ åˆ›å»ºäº:  2h30m ago
```

**`/sessionList` è¾“å‡ºç¤ºä¾‹**
```
ğŸ–¥ æ‰€æœ‰ tmux çª—å£

@0  claude @ my-app        â† å·²ç»‘å®š Topic "åç«¯å¼€å‘"
@1  codex @ api-server     â† å·²ç»‘å®š Topic "APIé‡æ„"
@2  bash @ scripts         â† æœªç»‘å®š [ç‚¹å‡»ç»‘å®š]
@3  gemini @ ml-project    â† æœªç»‘å®š [ç‚¹å‡»ç»‘å®š]
```

**æ¶ˆæ¯äº¤äº’**
- Topic å†…å‘æ–‡æœ¬ â†’ `tmux send-keys` åˆ°ç»‘å®šçª—å£ï¼ˆæ‰€æœ‰åç«¯é€šç”¨ï¼‰
- è¾“å‡ºç›‘æ§ â†’ æ ¹æ®åç«¯ç±»å‹è‡ªåŠ¨é€‰æ‹©ï¼šAI å·¥å…·ç”¨æ—¥å¿—æ–‡ä»¶ç›‘æ§ï¼Œbash ç”¨ capture-pane
- æ”¯æŒæµå¼æ¨é€ï¼ˆä¼˜å…ˆä½¿ç”¨ Bot API 9.3 çš„ sendMessageDraftï¼Œé™çº§ä¸º editMessage èŠ‚æµï¼‰

**æ§åˆ¶å‘½ä»¤**
- `/esc` - å‘é€ Escape é”®ï¼ˆä¸­æ–­ Claudeï¼‰
- `/enter` - å‘é€å›è½¦é”®
- `/y` `/n` - å¿«æ·å›å¤æƒé™ç¡®è®¤
- `/screenshot` - æ•è· tmux çª—å£å†…å®¹ï¼Œæ¸²æŸ“ä¸ºå›¾ç‰‡å‘é€
- `/claude` {argç”¨æˆ·è¾“å…¥} - åŸç”Ÿçš„claudeæŒ‡ä»¤é€ä¼ ï¼Œå¦‚/configã€/modelç­‰, åœ¨å½“å‰ç»‘å®šæ˜¯claudeçš„æ‰å±•ç¤º
- `/codex` {argç”¨æˆ·è¾“å…¥} - åŸç”Ÿçš„codexæŒ‡ä»¤é€ä¼ ï¼Œå¦‚/configã€/modelç­‰, åœ¨å½“å‰ç»‘å®šæ˜¯codexçš„æ‰å±•ç¤º
- `/gemini` {argç”¨æˆ·è¾“å…¥} - åŸç”Ÿçš„geminiæŒ‡ä»¤é€ä¼ ï¼Œå¦‚/configã€/modelç­‰, åœ¨å½“å‰ç»‘å®šæ˜¯geminiçš„æ‰å±•ç¤º


**çŠ¶æ€æŒä¹…åŒ–**
- Topic â†” tmux window ç»‘å®šå…³ç³»ï¼ˆå«åç«¯ç±»å‹ï¼‰
- å„ Topic çš„å·²è¯»åç§»é‡
- å¸¸ç”¨ç›®å½•åˆ—è¡¨ï¼ˆæ”¶è— + æœ€è¿‘ä½¿ç”¨ï¼‰
- é‡å¯åè‡ªåŠ¨æ¢å¤ç»‘å®š

**å¸¸ç”¨ç›®å½•ç®¡ç†**
- æ‰‹åŠ¨æ”¶è—ï¼š`/dir add <è·¯å¾„>` æ·»åŠ æ”¶è—ï¼Œ`/dir rm <è·¯å¾„>` ç§»é™¤
- `/dirs-fav` åˆ—å‡ºæ‰€æœ‰æ”¶è— + æœ€è¿‘ä½¿ç”¨
- `/dir` åˆ—å‡ºï½æ ¹ç›®å½•ä¸‹å†…å®¹ï¼Œåç»­é€å±‚ç‚¹å‡»å±•ç¤ºï¼Œå‘ˆç°ï¼šã€è¿›å…¥ï¼Œæ·»åŠ æ”¶è—ã€‘

### P1 - å¢å¼º

**Web UIï¼ˆå¯å…³é—­ï¼‰**
- é…ç½®é¡¹ `web.enabled: false` é»˜è®¤å…³é—­
- å¼€å¯åç›‘å¬æœ¬åœ°ç«¯å£ï¼Œæä¾›ï¼š
  - ä¼šè¯åˆ—è¡¨å’ŒçŠ¶æ€æ€»è§ˆ
  - å®æ—¶ç»ˆç«¯è¾“å‡ºï¼ˆWebSocketï¼‰
  - åŸºç¡€æ“ä½œï¼ˆå‘æ¶ˆæ¯ã€ä¸­æ–­ã€åˆ‡æ¢ï¼‰
- å‰ç«¯ç”¨çº¯ HTML + vanilla JSï¼Œembed è¿›äºŒè¿›åˆ¶
- ä¸åš Mini Appï¼Œä»…ä½œä¸ºæœ¬åœ°è¾…åŠ©é¢æ¿

**æ¶ˆæ¯å¢å¼º**
- å†…è”é”®ç›˜ï¼šæƒé™ç¡®è®¤æŒ‰é’®ï¼ˆYes/No/Alwaysï¼‰
- é•¿æ¶ˆæ¯è‡ªåŠ¨åˆ†å‰²ï¼ˆTelegram 4096 å­—ç¬¦é™åˆ¶ï¼‰
- Markdown æ¸²æŸ“å¤±è´¥è‡ªåŠ¨é™çº§çº¯æ–‡æœ¬

**æ–‡ä»¶äº¤äº’**
- å‘é€å›¾ç‰‡ â†’ ä¿å­˜åˆ°é¡¹ç›®ä¸´æ—¶ç›®å½•ï¼Œè·¯å¾„ä¼ ç»™ Claude
- å‘é€æ–‡ä»¶ â†’ åŒä¸Š

## å‘½ä»¤é€ŸæŸ¥è¡¨

| å‘½ä»¤ | è¯´æ˜ | åœºæ™¯ |
|---|---|---|
| `/new` | æ–°å»ºä¼šè¯ï¼ˆé€‰ç›®å½•+é€‰åç«¯ï¼‰ | æœªç»‘å®šæ—¶è‡ªåŠ¨è§¦å‘ï¼Œä¸ä¸»åŠ¨å‘ˆç°åœ¨èœå• |
| `/sessionInfo` | æŸ¥çœ‹å½“å‰ç»‘å®šä¼šè¯è¯¦æƒ…ï¼ˆçª—å£ã€ç›®å½•ã€åç«¯ã€å‘½ä»¤ã€æ—¶é•¿ï¼‰ï¼Œæœªç»‘å®šæ—¶ç›®å½•ä¸ºå½“å‰ç›®å½•å…¶ä»–ä¸ºç©º | ä»»æ„æ—¶åˆ» |
| `/sessionList` | åˆ—å‡ºæ‰€æœ‰ tmux çª—å£ï¼Œæœªç»‘å®šçš„å¯ç‚¹å‡»ç»‘å®š(åœ¨å½“å‰æœªç»‘å®šå‰æ)ï¼Œä¹Ÿå¯ç‚¹å‡»å…³é—­ | ä»»æ„æ—¶åˆ» |
| `/esc` | å‘é€ Escape é”®ï¼Œä¸­æ–­å½“å‰åç«¯ | å·²ç»‘å®šæ—¶å¯ç”¨ |
| `/enter` | å‘é€å›è½¦é”® | å·²ç»‘å®šæ—¶å¯ç”¨ |
| `/y` `/n` | å¿«æ·å›å¤æƒé™ç¡®è®¤ | å·²ç»‘å®šæ—¶å¯ç”¨ |
| `/screenshot` | æˆªå›¾ tmux çª—å£ï¼Œæ¸²æŸ“ä¸ºå›¾ç‰‡å‘é€ | å·²ç»‘å®šæ—¶å¯ç”¨ |
| `/claude` {arg} | Claude Code åŸç”ŸæŒ‡ä»¤é€ä¼ ï¼ˆå¦‚ /configã€/modelï¼‰ | ç»‘å®š claude æ—¶å±•ç¤º |
| `/codex` {arg} | Codex åŸç”ŸæŒ‡ä»¤é€ä¼  | ç»‘å®š codex æ—¶å±•ç¤º |
| `/gemini` {arg} | Gemini åŸç”ŸæŒ‡ä»¤é€ä¼  | ç»‘å®š gemini æ—¶å±•ç¤º |
| `/dir` | ä»å½“å‰å·¥ä½œç›®å½•é€å±‚æµè§ˆï¼Œå¯ã€è¿›å…¥ã€‘æˆ–ã€æ·»åŠ æ”¶è—ã€‘ | ä»»æ„æ—¶åˆ» |
| `/dirs-fav` | åˆ—å‡ºæ‰€æœ‰æ”¶è—ç›®å½• + æœ€è¿‘ä½¿ç”¨ç›®å½• | ä»»æ„æ—¶åˆ» |

## é¡¹ç›®ç»“æ„

```
tgmux/
â”œâ”€â”€ main.go                 # å…¥å£ï¼ŒCLI å‚æ•°è§£æï¼Œå¯åŠ¨ bot + web
â”œâ”€â”€ config/
â”‚   â””â”€â”€ config.go           # YAML é…ç½®åŠ è½½ + CLI flag åˆå¹¶
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ backend.go          # Backend æ¥å£å®šä¹‰
â”‚   â”œâ”€â”€ claude.go           # Claude Codeï¼šå¯åŠ¨å‘½ä»¤ + JSONL ç›‘æ§
â”‚   â”œâ”€â”€ codex.go            # Codexï¼šå¯åŠ¨å‘½ä»¤ + JSONL ç›‘æ§
â”‚   â”œâ”€â”€ gemini.go           # Geminiï¼šå¯åŠ¨å‘½ä»¤ + JSON ç›‘æ§
â”‚   â””â”€â”€ bash.go             # Bashï¼šç›´æ¥ shell + capture-pane ç›‘æ§
â”œâ”€â”€ bot/
â”‚   â”œâ”€â”€ bot.go              # Telegram bot åˆå§‹åŒ–ã€polling
â”‚   â”œâ”€â”€ handlers.go         # å‘½ä»¤å¤„ç†å™¨
â”‚   â””â”€â”€ keyboard.go         # å†…è”é”®ç›˜æ„å»ºï¼ˆåç«¯é€‰æ‹©ã€ç›®å½•é€‰æ‹©ï¼‰
â”œâ”€â”€ tmux/
â”‚   â”œâ”€â”€ manager.go          # tmux çª—å£åˆ›å»º/é”€æ¯/send-keys
â”‚   â””â”€â”€ capture.go          # capture-pane + æˆªå›¾æ¸²æŸ“
â”œâ”€â”€ monitor/
â”‚   â”œâ”€â”€ jsonl.go            # fsnotify ç›‘å¬ JSONLï¼ˆClaude ä¸“ç”¨ï¼‰
â”‚   â”œâ”€â”€ pane.go             # capture-pane è½®è¯¢ï¼ˆbash ä¸“ç”¨ï¼‰
â”‚   â””â”€â”€ dispatcher.go       # æ ¹æ®åç«¯ç±»å‹åˆ†å‘åˆ°å¯¹åº”ç›‘æ§å™¨
â”œâ”€â”€ state/
â”‚   â””â”€â”€ store.go            # ç»‘å®šå…³ç³» + åç§»é‡ + å¸¸ç”¨ç›®å½•æŒä¹…åŒ–
â”œâ”€â”€ web/                    # å¯é€‰ Web UI
â”‚   â”œâ”€â”€ server.go           # HTTP + WebSocket æœåŠ¡
â”‚   â””â”€â”€ static/             # embed.FS é™æ€èµ„æº
â”‚       â”œâ”€â”€ index.html
â”‚       â””â”€â”€ app.js
â”œâ”€â”€ config.example.yaml
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â”œâ”€â”€ Makefile
â””â”€â”€ README.md
```

## é…ç½®æ–‡ä»¶

```yaml
# ~/.tgmux/config.yaml
telegram:
  token: "your-bot-token"
  allowed_users:
    - 123456789
backends:
  claude:
    command: "claude"        # å¯åŠ¨å‘½ä»¤ï¼Œå¯è‡ªå®šä¹‰å‚æ•°
    args: []                 # å¦‚ ["--dangerously-skip-permissions"]
  codex:
    command: "codex"
    args: []
  gemini:
    command: "gemini"
    args: []
  bash:
    command: ""              # ç©ºåˆ™ç›´æ¥ä½¿ç”¨é»˜è®¤ shell

dirs:
  favorites: []              # æ‰‹åŠ¨æ”¶è—çš„ç›®å½•ï¼Œä¹Ÿå¯é€šè¿‡ /dir add ç®¡ç†
  recent_max: 10             # æœ€è¿‘ä½¿ç”¨ç›®å½•æœ€å¤§è®°å½•æ•°

web:
  enabled: false
  port: 3030

monitor:
  poll_interval: 500ms       # capture-pane è½®è¯¢é—´éš”
  message_throttle: 500ms    # Telegram æ¶ˆæ¯ç¼–è¾‘èŠ‚æµ
```

## çŠ¶æ€æ–‡ä»¶

```json
{
  "bindings": {
    "topic_123": {
      "window_id": "@0",
      "backend": "claude",
      "project_path": "/home/user/my-project",
      "display_name": "claude @ my-project",
      "created_at": "2026-02-12T10:00:00Z"
    },
    "topic_456": {
      "window_id": "@1",
      "backend": "codex",
      "project_path": "/home/user/other-project",
      "display_name": "codex @ other-project",
      "created_at": "2026-02-12T11:00:00Z"
    }
  },
  "offsets": {
    "topic_123": {
      "file": "/path/to/session.jsonl",
      "byte_offset": 4096
    }
  },
  "dirs": {
    "favorites": ["/home/user/my-project", "/home/user/work"],
    "recent": ["/home/user/other-project", "/home/user/my-project"]
  }
}
```

## å…³é”®å®ç°è¦ç‚¹

**tmux äº¤äº’**
```
åˆ›å»ºçª—å£:  tmux new-window -t tgmux -n "claude-my-project"
è¿›å…¥ç›®å½•:  tmux send-keys -t tgmux:@0 "cd /path/to/project" Enter
å¯åŠ¨åç«¯:  tmux send-keys -t tgmux:@0 "claude" Enter
å‘é€æ–‡æœ¬:  tmux send-keys -t tgmux:@0 -l "user message"
å‘é€å›è½¦:  tmux send-keys -t tgmux:@0 Enter
å‘é€ESC:   tmux send-keys -t tgmux:@0 Escape
æ•è·å†…å®¹:  tmux capture-pane -t tgmux:@0 -p -e
```

**è¾“å‡ºç›‘æ§ï¼ˆåŒç­–ç•¥ï¼‰**

ç­–ç•¥ä¸€ï¼šæ—¥å¿—æ–‡ä»¶ç›‘æ§ï¼ˆClaude / Codex / Geminiï¼‰
1. fsnotify ç›‘å¬å¯¹åº”æ—¥å¿—ç›®å½•
   - Claude: `~/.claude/projects/<hash>/`
   - Codex: `~/.codex/sessions/YYYY/MM/DD/`
   - Gemini: `~/.gemini/tmp/<hash>/chats/`
2. æ–‡ä»¶å˜åŒ–æ—¶ï¼Œä»ä¸Šæ¬¡ byte_offset å¼€å§‹å¢é‡è¯»å–
3. é€è¡Œè§£æ JSONï¼Œæå– assistant æ¶ˆæ¯ã€tool_use ç­‰
4. æ ¼å¼åŒ–åæ¨é€åˆ°å¯¹åº” Topic
5. æ›´æ–° byte_offset

ç­–ç•¥äºŒï¼šcapture-pane è½®è¯¢ï¼ˆbashï¼‰
1. å®šæ—¶æ‰§è¡Œ `tmux capture-pane -p -e` è·å–çª—å£å†…å®¹
2. ä¸ä¸Šæ¬¡å¿«ç…§ diffï¼Œæå–æ–°å¢è¡Œ
3. è¿‡æ»¤ ANSI è½¬ä¹‰åºåˆ—ï¼Œæ ¼å¼åŒ–åæ¨é€åˆ°å¯¹åº” Topic
4. æ›´æ–°å¿«ç…§

**æµå¼æ¨é€ç­–ç•¥ï¼ˆåŒæ¨¡å¼ï¼‰**

æ–¹æ¡ˆä¸€ï¼ˆä¼˜å…ˆï¼‰ï¼šBot API 9.3+ `sendMessageDraft`
- æ–°å†…å®¹åˆ°è¾¾ â†’ è°ƒç”¨ sendMessageDraft è¿½åŠ éƒ¨åˆ†æ–‡æœ¬
- Telegram å®¢æˆ·ç«¯åŸç”Ÿæ¸²æŸ“æµå¼æ•ˆæœï¼Œæ— éœ€åå¤ç¼–è¾‘æ¶ˆæ¯
- è¾“å‡ºå®Œæˆ â†’ å‘é€æœ€ç»ˆå®Œæ•´æ¶ˆæ¯

æ–¹æ¡ˆäºŒï¼ˆé™çº§ï¼‰ï¼šeditMessage èŠ‚æµ
- sendMessageDraft ä¸å¯ç”¨æ—¶è‡ªåŠ¨é™çº§
- æ–°å†…å®¹åˆ°è¾¾ â†’ è¿½åŠ åˆ° buffer
- 500ms èŠ‚æµ â†’ editMessageText æ›´æ–°æ¶ˆæ¯
- è¶…è¿‡ 3800 å­—ç¬¦ â†’ å®šç¨¿å½“å‰æ¶ˆæ¯ï¼Œå‘æ–°æ¶ˆæ¯ç»§ç»­
- Markdown è§£æå¤±è´¥ â†’ é™çº§çº¯æ–‡æœ¬é‡è¯•

## æ„å»ºä¸è¿è¡Œ

```bash
# æ„å»º
make build    # â†’ ./bin/tgmux

# è¿è¡Œ
tgmux                                # ä½¿ç”¨é»˜è®¤é…ç½® ~/.tgmux/config.yaml
tgmux -c /path/to/config.yaml        # æŒ‡å®šé…ç½®æ–‡ä»¶
tgmux --web                          # å¯ç”¨ Web UI
tgmux --web --web-port 9090          # å¯ç”¨ Web UI å¹¶æŒ‡å®šç«¯å£

# å¼€å‘
make dev      # go run with -race
make lint     # golangci-lint
make test     # go test ./...
```

**CLI å‚æ•°ä¼˜å…ˆçº§**: å‘½ä»¤è¡Œå‚æ•° > ç¯å¢ƒå˜é‡ > é…ç½®æ–‡ä»¶ > é»˜è®¤å€¼

## éç›®æ ‡

- ä¸åš Telegram Mini Appï¼ˆå¤æ‚åº¦é«˜ï¼Œéœ€è¦ HTTPSï¼‰
- ä¸åš Agent SDK é›†æˆï¼ˆtmux æ¡¥æ¥å·²è¶³å¤Ÿï¼Œä¿æŒç®€å•ï¼‰
- ä¸åšæ•°æ®åº“ï¼ˆJSON æ–‡ä»¶è¶³çŸ£ï¼‰
- ä¸åšå¤šæœºéƒ¨ç½²ï¼ˆå•æœºå·¥å…·ï¼‰
- ä¸åšè‡ªåŠ¨æ›´æ–°
- ä¸åšåç«¯èƒ½åŠ›æŠ½è±¡ï¼ˆå„åç«¯å·®å¼‚å¤§ï¼Œç»Ÿä¸€æ¥å£ä»…é™ tmux å±‚é¢çš„è¾“å…¥/è¾“å‡ºï¼‰
